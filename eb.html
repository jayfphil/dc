<!DOCTYPE html>
<html lang="en">
<head>
	<title>EB Forms Portal</title>
	<meta name="description" content="">
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/style.min.css">
	<link rel="stylesheet" href="css/prism.css">
	<link rel="stylesheet" href="css/custom.css">
	<script src="js/modernizr.js"></script>
	<link rel="icon" type="image/png" sizes="192x192"  href="image/favicon/android-icon-192x192.png">
</head>
<body class="">


<div class="page js-page ">

	<div class="one-page-sidebar">
		<div class="one-page-sidebar-header">
			<div class="one-page-logo">
				<a href="#" target="_blank" class="logo-image ">
					EB Forms Portal
				</a>
			</div>
		</div>

		<div class="one-page-nav-wrapper js-custom-scrollbar">
			<ul class="one-page-nav js-one-page-nav js-menu-vertical">
				<li>
					<a href="#beginning">
						Setting Up
					</a>
				</li>
				<li>
					<a href="#structure">
						Files Structure
					</a>
				</li>
				<!-- <li>
					<a href="#html">
						HTML Structure
					</a>
				</li>
				<li>
					<a href="#css">
						CSS Structure
					</a>
				</li> -->
				<li>
					<a href="#js">
						Current EB Forms deployment
					</a>
				</li>
				<li>
					<a href="#force">
						Manual DDQ Force Complete
					</a>
				</li>
				<!-- <li>
					<a href="#tod">
						Turn-Over Document
					</a>
				</li> -->
			</ul>
		</div>

		<footer class="one-page-sidebar-footer">
			© <a href="mailto:psanpedro@ethixbase.com">Philkachu</a>, all rights reserved. 2018
		</footer>

	</div>

	<div class="one-page-content">

		<div id="content">
			<div class="container-fluid container-spaced">
				<div class="row">
					<div class="col-md-12">

						<div class="js-prepend-mobile-menu"></div>

						<div class="category-info helper pt0" id="getting-started">
							<br>
							<div>
									<h4 id="beginning">
										<b>Get started on Forms Portal</b>
									</h4>
									<hr>

									<h3>Step 1</h3>
									<p>Open your prefer terminal (I used docker) and clone this repository <b>https://git.ethixbase.com/bits/forms-portal.git</b> for EB Forms Portal.</p>
									<br />
									<h3>Step 2</h3>
									<p>After you cloned it. go to the <b>client</b> or <b>novartis-client</b> (<i>if you are working with Novartis</i>) directory</p>
									<pre><code class="language-javascript">cd client</code></pre>
									<p>Then run the command below</p>
									<pre><code class="language-javascript">npm install ngx-spinner@6.0.0</code></pre>
									<br />
									<h3>Step 3</h3>
									<p>After finish installing all the npm packages. we now install the composer to laravel <b>server</b> directory, go to the <b>server</b> directory from the root folder of <b>forms-portal</b>.</p>
									<pre><code class="language-javascript">cd ../server</code></pre>
									<p>Before we install the composer, you will have to comment out some code to prevent the post-autoload-dump that will return some error because of an active cron event. Edit this file <b><code>server->app->Console->Kernel.php</code></b> and comment out all codes inside the <b>schedule</b> function. </p>
									<p>Then run the command below</p>
									<pre><code class="language-javascript">composer install</code></pre>
									<p>If you encountered some error like <font color="orange">Ambiguous class resolution</font> please check the last person who commit on that file.</p>
									<h3>Step 4</h3>
									<p>Now we are all set and ready to run our forms portal application.</p>
									<p>go to the root directory of your <b>forms-portal</b> then run the command below where the file <b>docker-compose.yml</b> is exist.</p>
									<pre><code class="language-javascript">docker-compose up -d --build</code></pre>

									<h3>Step 5</h3>
									<p>And for the final step. You may run the forms-portal app on your on way whether you run the laravel artisan seperately or just run it on nginx.</p>

									<p>go to the <b>client</b> or <b>novartis-client</b> directory then run the command below to run the nginx app.</p>
									<pre><code class="language-javascript">ng serve --open</code></pre>
									<br /><br />
									<p>or if you want to run the laravel artisan seperately. go to the <b>server</b> directory then run the command below where the file <b>artisan</b> is exist.</p>
									<pre><code class="language-javascript">php artisan serve</code></pre>

								</div>
								<br>
								<br>
								<br>
							<div>
								<h4 id="structure">
									<b>Files Structure</b>

									<a class="fragment-identifier js-fragment-identifier fragment-identifier-scroll"
									   href="#structure">
										<i class="fa fa-link"></i>
									</a>

								</h4>
								<hr>
								<p class="category-content">
								<ul class="nav structure_list">
									<li>
										<i class="fa fa-folder"></i>
										forms-portal (<font color="red">Main directory</font>)

										<ul class="nav structure_step">
											<li>
												<i class="fa fa-folder"></i>
												build
												<ul class="nav structure_step">
													<li>
														<i class="fa fa-file"></i>
														app.dockerfile
													</li>
													<li>
														<i class="fa fa-file"></i>
														vhost.conf
													</li>
													<li>
														<i class="fa fa-file"></i>
														web.dockerfile
													</li>
												</ul>
											</li>
											<li>
												<i class="fa fa-folder"></i>
												admin (<font color="red">Add port <b>:7000</b> when accessing this on prod</font>)
												<ul class="nav structure_step">
													<li>
														<i class="fa fa-folder"></i>
														e2e
													</li>
													<li>
														<i class="fa fa-folder"></i>
														src
													</li>
													<li>
														<i class="fa fa-file"></i>
														.angular-cli.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														.editorconfig
													</li>
													<li>
														<i class="fa fa-file"></i>
														.gitignore
													</li>
													<li>
														<i class="fa fa-file"></i>
														karma.conf.js
													</li>
													<li>
														<i class="fa fa-file"></i>
														LICENSE
													</li>
													<li>
														<i class="fa fa-file"></i>
														package-lock.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														package.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														protractor.conf.js
													</li>
													<li>
														<i class="fa fa-file"></i>
														README.md
													</li>
													<li>
														<i class="fa fa-file"></i>
														tsconfig.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														tslint.json
													</li>
												</ul>
											</li>
											<li>
												<i class="fa fa-folder"></i>
												client (<font color="red">Contains client like Ascensia, Hapag-Lloyd, Malaysian Airlines, Kongsberg, Dentsply & ethiXbase DDQ form</font>)
												<ul class="nav structure_step">
													<li>
														<i class="fa fa-folder"></i>
														e2e
													</li>
													<li>
														<i class="fa fa-folder"></i>
														node_modules
													</li>
													<li>
														<i class="fa fa-folder"></i>
														src
													</li>
													<li>
														<i class="fa fa-file"></i>
														.angular-cli.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														.editorconfig
													</li>
													<li>
														<i class="fa fa-file"></i>
														karma.conf.js
													</li>
													<li>
														<i class="fa fa-file"></i>
														LICENSE
													</li>
													<li>
														<i class="fa fa-file"></i>
														package-lock.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														package.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														protractor.conf.js
													</li>
													<li>
														<i class="fa fa-file"></i>
														README.md
													</li>
													<li>
														<i class="fa fa-file"></i>
														tsconfig.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														tslint.json
													</li>
												</ul>
											</li>
											<li>
												<i class="fa fa-folder"></i>
												novartis-admin (<font color="red">Same as <b>admin</b> directory</font>)
											</li>
											<li>
												<i class="fa fa-folder"></i>
												novartis-client (<font color="red">Contains only Novartis client</font>)
												<ul class="nav structure_step">
													<li>
														<i class="fa fa-folder"></i>
														e2e
													</li>
													<li>
														<i class="fa fa-folder"></i>
														node_modules
													</li>
													<li>
														<i class="fa fa-folder"></i>
														src
													</li>
													<li>
														<i class="fa fa-file"></i>
														.angular-cli.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														.editorconfig
													</li>
													<li>
														<i class="fa fa-file"></i>
														.gitignore
													</li>
													<li>
														<i class="fa fa-file"></i>
														karma.conf.js
													</li>
													<li>
														<i class="fa fa-file"></i>
														LICENSE
													</li>
													<li>
														<i class="fa fa-file"></i>
														package-lock.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														package.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														protractor.conf.js
													</li>
													<li>
														<i class="fa fa-file"></i>
														README.md
													</li>
													<li>
														<i class="fa fa-file"></i>
														tsconfig.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														tslint.json
													</li>
												</ul>
											</li>
											<li>
												<i class="fa fa-folder"></i>
												server (<font color="red">Contains backend code</font>)
												<ul class="nav structure_step">
													<li>
														<i class="fa fa-folder"></i>
														app
													</li>
													<li>
														<i class="fa fa-folder"></i>
														bootstrap
													</li>
													<li>
														<i class="fa fa-folder"></i>
														config
													</li>
													<li>
														<i class="fa fa-folder"></i>
														database
													</li>
													<li>
														<i class="fa fa-folder"></i>
														images
													</li>
													<li>
														<i class="fa fa-folder"></i>
														public
													</li>
													<li>
														<i class="fa fa-folder"></i>
														resources
													</li>
													<li>
														<i class="fa fa-folder"></i>
														routes
													</li>
													<li>
														<i class="fa fa-folder"></i>
														storage
													</li>
													<li>
														<i class="fa fa-folder"></i>
														tests
													</li>
													<li>
														<i class="fa fa-folder"></i>
														vendor
													</li>
													<li>
														<i class="fa fa-file"></i>
														.env
													</li>
													<li>
														<i class="fa fa-file"></i>
														.env.example
													</li>
													<li>
														<i class="fa fa-file"></i>
														.env.prod.example
													</li>
													<li>
														<i class="fa fa-file"></i>
														.gitignore
													</li>
													<li>
														<i class="fa fa-file"></i>
														arabic-thin.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														ArabicMedium.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														array( (<font color="red">Please delete, i guess it is added accidentally</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														artisan
													</li>
													<li>
														<i class="fa fa-file"></i>
														composer.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														composer.lock
													</li>
													<li>
														<i class="fa fa-file"></i>
														DFLISB1B.TTF (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														DFLIYX1B.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														fireflysung.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														G5LISL1B.TTF (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														HDZB_24.TTF (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														loadfont.php
													</li>
													<li>
														<i class="fa fa-file"></i>
														package.json
													</li>
													<li>
														<i class="fa fa-file"></i>
														phpunit.xml
													</li>
													<li>
														<i class="fa fa-file"></i>
														readme.md
													</li>
													<li>
														<i class="fa fa-file"></i>
														server.php
													</li>
													<li>
														<i class="fa fa-file"></i>
														simsun.ttc
													</li>
													<li>
														<i class="fa fa-file"></i>
														UnDotum.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														UnShinmun.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														UnYetgul.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														webpack.mix.js
													</li>
													<li>
														<i class="fa fa-file"></i>
														wt021.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
													<li>
														<i class="fa fa-file"></i>
														wt034.ttf (<font color="red">I guess we might delete this fonts but dunno if there is an impact</font>)
													</li>
												</ul>
											</li>
											<li>
												<i class="fa fa-file"></i>
												.gitignore
											</li>
											<li>
												<i class="fa fa-file"></i>
												docker-compose.yml 
											</li>
										</ul>
									</li>

								</ul>
							</div>
							<br>
							<br>
							<br>
						</div>

						<div class="category-info " id="installation">
							<!-- <br>
							<div>
								<h4 id="html">
									<b>HTML Structure</b>

									<a class="fragment-identifier js-fragment-identifier fragment-identifier-scroll"
									   href="#html">
									</a>
								</h4>
								<hr>
								<div class="category-content">
									<div class="section_body">

										<div>This theme is a responsive. All of the information within the main content area is nested within a body element <br>
											<pre><code class="language-html">< body ></code></pre>

											<br> Page Content some code here <br>

										</div>
										
										<pre><code class="language-html">< /body ></code></pre>
										<h3>General Structure</h3>
										<p>Here is the general structure screen shot</p>
										<img src="image/structure.JPG" alt="screen" class="scr_shot">
										<br>
										<p> Every section start with a comment like this <br>
											<strong>
												<pre><code class="language-html"></code></pre>
												<br>
												and end with comment like this
												<br>
												<pre><code class="language-html"></code></pre>
												<br>
											</strong>
										</p>
									</div>
								</div>
							</div>
							<br>
							<br>
							<br>

							<div>
								<h4 id="css">
									<b>CSS Structure</b>
								</h4>
								<hr>


								<p> you will find the theme css file in <code>html->assets->css->style.css </code></p>
								<h3>list of content </h3>
								<p>Here is the list of all sections style </p>
								<pre><code class="language-css">




								</code></pre>
								<br>
								<p> Every point of the content list you will find start with a comment like this</p> <br>
								<pre><code class="language-css">

								</code></pre>



								<br>
								<br>
							</div> -->

								<div>
									<h4 id="js">
										<b>Current EB Forms deployment</b>
									</h4>
									<hr>
									<p>Our deployment on forms portal is still incomplete as of now, because there is no automation of building and compiling of your committed angular code changes that will straightaway reflect on the forms portal environment except for laravel which is the <b>server</b> directory.</p>
									<p>So for now you will be doing the deployment manually.</p>
									<h3>Step 1</h3>
									<p>Go to the <b>client</b> or <b>novartis-client</b> directory and start with the production build:</p>
									<pre><code class="language-javascript">ng build --env=prod --no-sourcemaps</code></pre>
									<br>
									<h3>Step 2</h3>
									<p>Copy everything inside the (<b>dist/ by default</b>) within the output directory.</p>
									<img src="image/sample_dist_dir.PNG" alt="screen" class="scr_shot">
									<br><br>
									<h3>Step 3</h3>
									<p>And paste or overwrite everything to a directory on the server E.g. Repository:<b>novartis.eb-forms</b> -> Branch:<b>staging</b> -> Directory:<b>eu.eb-forms.ethixbase.com_html</b> </p>
									<img src="image/sample_replace_dir.PNG" alt="screen" class="scr_shot">
									<br><br>
									<h3>Step 4</h3>
									<p>Then we will try to run some laravel artisan console commands so our code changes will reflect clearly on forms portal environment but we will use some ssh client tool for that to happen. (I used Putty) Download and open the ssh client tool you have and connect to the server with your IDM credentials. Do not attempt to access servers based on PUBLIC HOSTNAMES … some servers are HIDDEN/MASQUERADED behind Reverse proxies (Why? Because Peter Malaty's bypassing restrictions in other countries as is the case with Novartis). Use only IPs. E.g. below</p>
									<pre><code class="language-javascript">us-forms.dev.ethixbase.com -> 54.69.196.176</code></pre>
									<br>
									<h3>Step 5</h3>
									<p>After you enter your credentials, type the command below and enter your password again.</p>
									<pre><code class="language-javascript">sudo -i</code></pre>
									<br>
									<h3>Step 6</h3>
									<p>Then go to the backend <b>server</b> directory of forms-portal.</p>
									<pre><code class="language-javascript">cd /var/www/html/eu.eb-forms.ethixbase.com_html</code></pre>
									<br>
									<h3>Step 7</h3>
									<p>When you are now inside the said path, run all the commands below.</p>
									<pre><code class="language-javascript">php artisan config:cache</code></pre>
									<pre><code class="language-javascript">php artisan route:cache</code></pre>
									<pre><code class="language-javascript">php artisan view:clear</code></pre>
									<pre><code class="language-javascript">php artisan view:cache</code></pre>
									<p>All done! the codes has successfully deployed to the forms portal.</p>
									<br>

								</div>
								<br>
								<br>
								<br>
								<div>
									<h4 id="force">
										<b>Manual DDQ Force Complete</b>
									</h4>
									<hr>

									<h3>Step 1</h3>
									<p>Start using some sftp tools for uploading the offline DDQ to the platform (I used Filezilla btw). Download and open the sftp tool you have and connect to the server with your IDM credentials (You must be connected to VPN). you make sure to transfer the file on your home directory E.g. (<b>/home/philkachu</b>) because it is restricted to transfer files outside of your home directory and also make sure you rename the file with some date and time so there will be no overwriting of files.</p>
									<img src="image/sample_file_transferring.PNG" alt="screen" class="scr_shot">
									<br /><br />
									<h3>Step 2</h3>
									<p>Then we will try now to move those offline ddq file to <b>/forms_portal_dirs/eb_forms_pdf</b> but we will use some ssh client tool for that to happen. (I used Putty) Download and open the ssh client tool you have and connect to the server with your IDM credentials. Then type the command below and enter your password again.</p>
									<pre><code class="language-javascript">sudo -i</code></pre>
									<p>After that type the command below in order.</p>
									<pre><code class="language-javascript">cd /home/philkachu</code></pre>
									<pre><code class="language-javascript">mv * /forms_portal_dirs/eb_forms_pdf</code></pre>
									<p>All done! the file has successfully been uploaded to the platform, now we update the third party DDQ status.</p>
									<br />
									<h3>Step 3</h3>
									<p>Connect to the platform database server and find the third party's ddq status on <b>ethixb01_db->forms_qsttcomms</b> look for the <b>srch_id</b></p>
									<img src="image/sample_table_forms_qsttcomms.PNG" alt="screen" class="scr_shot">
									
									<h3>Step 4</h3>
									<p>Execute the sql script below so that will update the <b>form_status</b> as Completed, <b>form_dailybatch</b> and <b>form_weeklybatch</b> for daily and weekly cron report, <b>form_link</b> for the destination of the DDQ file path and <b>form_name</b> for the file name of DDQ report: we set it <b>Due Diligence Questionnaire</b> as default name.</p>

									<pre><code class="language-javascript">UPDATE forms_qsttcomms SET form_name='Due Diligence Questionnaire', form_link='NOVARTIS DD 2018.pdf',form_status=1,forms_dailybatch=1,form_weeklybatch=1 WHERE form_type='forms' AND form_srch_id=85178</code></pre>
									<br />
									<h3>Step 5</h3>
									<p>Execute the sql script below so that may add an audit log for ddq</p>

									<pre><code class="language-javascript">INSERT INTO audit_trail_logs (vendor_id,notes,company_id,type) values ('?VENDOR_ID?',"Due Diligence Questionnaire submitted",'?COMPANY_ID?',1);</code></pre>
									<br>
									<h3>Step 6</h3>
									<p>And now Connect to the EB forms portal database server and find the third party's form status on <b>eb_forms->user_documents</b> look for the <b>srch_id</b>, we also need to update this so it will sync in to our DDQ summary reports</p>
									<img src="image/sample_table_user_documents.PNG" alt="screen" class="scr_shot">
									<br>
									<h3>Step 7</h3>
									<p>Execute the sql script below so that will update the <b>document_status</b> as Completed and the <b>date_submitted</b></p>

									<pre><code class="language-javascript">UPDATE user_documents SET date_submitted=NOW(), document_status=1 WHERE srch_id=85178</code></pre>

								</div>
								<br>
								<br>
								<br>
						</div>
					</div>
				</div>
			</div>	
		</div>	
	</div>	
</div>						
						<script src="js/prism.js"></script>
						<script src="js/all.js"></script>
						<script src="js/custom.js"></script>
</body>
</html>
